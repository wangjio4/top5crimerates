---
title: "The Crime rates in Canada: Evidence From Five Highest Crime rates Neighbourhoods"
author: "Jiongan Wang"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  pdf_document: default
  word_document: default
abstract: This report uses crime rates data of 140 Neighbourhoods of Tronoto and extracts the top 5 neighbourhood with maximum number of crime. The data shows that crime has gradually increased from 2014 to 2019 in the Neighbourhood area of Toronto and indicates better police survillance. Howwever, the per capita crime rates data of these top 5 Neighbourhood demonstrates that area with higher population have lower number of crime rates and vice-versa.

thanks: The codes are avaiable at [https://github.com/wangjio4/top5crimerates](https://github.com/wangjio4/top5crimerates).
bibliography: reff.bib
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
rm(list=ls())
library(dplyr)
library(tidyverse)
library(bookdown)    # for cross referencing figures and graphs; referencing
library(scales)      # for fixing date axes
library(DescTools)   # for capitalizing graph labels
library(lubridate)   # extract month from date_scored
library(kableExtra)  # for nicer tables
library(opendatatoronto) #read data directly from the data portal
library(ggplot2)
library(reshape2)
```

# 1. Introduction

The growth in the crime rates is one of the most challenging problems in society. Government from all over the world are continuously working to frame out effective policies to reduce the crime rates. The term “Crime” is an old word that used to change over the period. In the ancient era, theft is defined as a crime that means taking any physical assets such as cash, jewelry from anyone forcibly. On the contrary to it, theft in the modern world is not limited to these physical assets but also includes data theft, digital theft, etc. Laws are made to prevent citizens from crimes but it is observed that in recent years are witnessed the inducement of crimes all over the world. Racism is one of the prime factors spreading crime in a country and US, the racism against black people left out their residential areas underdeveloped. Due to lack of employment and other facilities, the crime rates of black people have tremendously increased until 1971, when the strict anti-crime law, with the support of the people, has been imposed in the US, @marable.\par

Similar to the US, Canada has also imposed serious punishments against crimes such as drugs. These strict punishments include life imprisonment for a drug-related crime which is one example of discriminatory crime and its punishment prevailed in Canada @dekeseredy.  Similarly, discrimination based on race can lead to higher crime and can result in higher chaos among people which can further affect the economic growth and development in the country @owusubempah. Canada has also experienced a higher number of crimes in recent years. The crime data based on race are either forged or unavailable in Canada. Therefore, tracking the crime rates based on race is hard to follow in Canada.\par

This study uses the crime data from 2014 to 2019 available at @opendatatoronto, which includes the crime data of 140 neighborhoods of Toronto. Based on these neighborhoods, this study extracts the top 5 neighborhoods which have the highest number of crimes among the neighborhood. This study also investigates the per capita crime of these five neighborhoods which can provide a big picture of crime rates based on the population in these neighborhoods.

# 2. Data

```{r data load from opentoronto, include=FALSE}

Toronto_Crime <- read.csv(here::here("~/inputs/data/raw_data.csv"))
head(Toronto_Crime)
```

This study has used @opendatatoronto database to access the neighborhood crime rate data @toronto using software @citeR. The database is free and open which includes a variety of datasets based on Canada. The neighborhood crime rate data is maintained and published by the Toronto Police Administration and has an annual frequency from 2014 to 2019. The raw dataset contains 140 neighborhood crime rate data of Toronto. The crime rates include Assault, Auto theft, Break, Homicide, Theft Over, and Robbery in each of these neighborhoods.\par

```{r}
Clean_Toronto_Crime <- Toronto_Crime %>%
  as_tibble() %>%
  select(Neighbourhood, Assault_2014, Assault_2015, Assault_2016, Assault_2017, Assault_2018, Assault_2019, AutoTheft_2014, AutoTheft_2015, AutoTheft_2016, AutoTheft_2017, AutoTheft_2018, AutoTheft_2019, BreakAndEnter_2014, BreakAndEnter_2015, BreakAndEnter_2016, BreakAndEnter_2017, BreakAndEnter_2018, BreakAndEnter_2019, Homicide_2014, Homicide_2015, Homicide_2016, Homicide_2017, Homicide_2018, Homicide_2019, TheftOver_2014, TheftOver_2015, TheftOver_2016, TheftOver_2017, TheftOver_2018, TheftOver_2019, Robbery_2014, Robbery_2015, Robbery_2016, Robbery_2017, Robbery_2018, Robbery_2019)
```

The raw data is collected using the @opendatatoronto database and the IDs are excluded for each of the neighborhoods as names are more convenient than IDs for recognizing the neighborhood in the data set.  The dataset is cleaned using the R package of @devtools and @dplyr. Using the R package @reshape2, the data is constituted into a single data frame to obtain a new variable that indicates the total crime in each year by neighborhood. Then, the top five neighborhoods are selected which have the highest number of crimes per year from the dataset.

```{r}
### top 5 neighbourhoods with the most crimes ###
top5_toronto_crime <- Clean_Toronto_Crime %>%
  melt(id = c("Neighbourhood"), # using `reshape2` to change dataframe to long-format data for plotting. kept Neighbourhood as the ID
       variable.name = "Year",
       value.name = "Number_of_Crimes") %>%
  group_by(Neighbourhood) %>%
  summarise(Number_of_Crimes = sum(Number_of_Crimes)) %>% # summing crime by neighbourhood 
  slice_max(Number_of_Crimes, n = 5) # selecting 5 neighbourhoods with the most crime

```

```{r}
### Finding population data of the top 5 neighbourhoods ###
toronto_crime_pop <- Toronto_Crime %>%
  as_tibble() %>%
  select(Neighbourhood, F2020_Population_Projection) %>%
  filter(Neighbourhood %in% c("Waterfront Communities-The Island", "Bay Street Corridor", "Church-Yonge Corridor", "West Humber-Clairville", "Moss Park"))
```


```{r}
### Merging population and crime dataframes ###
compare_pop_crime <- merge(x = top5_toronto_crime, y = toronto_crime_pop, by = "Neighbourhood", all = TRUE)
```


```{r}
### Graphing neighbourhoods with the highest crime numbers and their population ###
compare_pop_crime %>% # plotting the number of crimes with their population
  ggplot(aes(x = reorder(Neighbourhood, -F2020_Population_Projection), y = Number_of_Crimes, fill = F2020_Population_Projection)) + # ordered by population size
  geom_bar(stat = "identity", position = position_dodge(), color="red") +
  labs(x = "Top 5 Neighbourhood",
       y = "Number of Crimes",
       title = "Top 5 neighbourhoods with the most crimes 2014-2019") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Figure 1 represents the Crime rates of these five highest crime rates neighborhoods using R package @ggplot2. The five neighborhoods with the highest number of crimes are “Waterfront Communities-The Island”, “Church-Yonge Corridor”, “West Humber Clareville”, “Bay Street Corridor” and “Moss Park”, respectively. Table 2 represents the total population of these five neighborhoods which indicates “Waterfront Communities-The Island” has the highest population followed by other neighborhoods, respectively.

```{r echo=FALSE}
### Understanding neighbourhood population ###
toronto_crime_pop_overall <- Toronto_Crime %>%
  as_tibble() %>%
  select(Neighbourhood, F2020_Population_Projection) %>%
  summarize(
    The_min = min(F2020_Population_Projection),
    The_max = max(F2020_Population_Projection),
    Mean = mean(F2020_Population_Projection),
    Std_dev = sd(F2020_Population_Projection)) %>%
  arrange(desc(Mean))
```

```{r}
toronto_crime_pop_overall %>%
  knitr::kable(caption = " Summary of Neighbourhood Populations.", 
               col.names = c(" Minimum", "Maximum", "Average", "Standard Deviation"),
               align = c('c', 'c', 'c', 'c'),
               booktabs = T) %>%
  kable_styling(full_width = T)
```

Table 1 demonstrates the summary of these five highest crime rates neighborhoods which includes minimum, maximum, mean, and standard deviation using the R package @kableExtra . 

```{r}
### Selected 5 Neighbourhood's populations ###
toronto_crime_pop %>%
  arrange(desc(F2020_Population_Projection)) %>%
  knitr::kable(caption = "Summary of Top5 Neighbourhod Populations.", 
               col.names = c("Top 5 Neighbourhood", "Population"),
               align = c('c', 'c'),
               booktabs = T) %>%
  kable_styling(full_width = T) %>%
  column_spec(1, width = "10cm")
```

```{r}

per_capita <- compare_pop_crime%>%
  transform(per_capita = (Number_of_Crimes / F2020_Population_Projection) * 100000)
```


```{r}
#graph of Per capita  crime rates in top 5 neighbourhood 
per_capita %>%
  ggplot(aes(x = reorder(Neighbourhood, -per_capita), y = per_capita, fill = F2020_Population_Projection,)) +
  geom_bar(stat = "identity", position = position_dodge(), color= "red") +
  labs(x = "Top 5 Neighbourhood",
       y = "Per CapitaCrimes",
       title = " Top 5 Neighbourhood Crime Per Capita at Toronto 2014-2019")+
         theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

From figure and table 1, it is observed that “Waterfront Communities-The Island” has the highest population and so as the crime rates. The highest crime in this neighborhood is due to the highest population and therefore, it is essential to create a crime per capita to investigate whether the crime rates differ based on the density of population. To do that, this study calculated the per capital crime rates and construct figure 2 using the R package @ggplot2 which demonstrates the crime rates per capita among these five neighborhoods. According to figure 2, “Moss Park” has the highest per capita crime despite low population, and the highest population area “Waterfront Communities-The Island” has the lowest per capita crime.

# 3. Conclusion

This study is based on investigating the top five neighborhoods of Toronto which have the highest crime rates by using the crime dataset obtained from the Toronto open database (@opendatatoronot) from 2014-2019, respectively. The data is cleaned and filtered using different packages available at R. The five neighborhoods with the highest number of crimes are “Waterfront Communities-The Island”, “Church-Yonge Corridor”, “West Humber Clareville”, “Bay Street Corridor” and “Moss Park”. On the contrary, the “Moss Park” has the highest per capita crime despite low population, and the highest population area “Waterfront Communities-The Island” has the lowest per capita crime. Furthermore, this study is based on grpahichal analysis and does not include any statistical model, further study can incorporated by investigating different dimensions of this dataset.

\pagebreak

# References
```